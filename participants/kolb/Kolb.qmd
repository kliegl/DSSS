---
title: "Simon Kolb: What Affects Waist-Hip Ratio?"
author: "Reinhold Kliegl"
date: "2022-09-017 (last revised: `r format(Sys.time())`)"
format: 
  html:
    embed-resources: true
    toc: true
    toc-depth: 2
    number-sections: true
    fig-width: 8
    fig-height: 6
editor_options: 
  chunk_output_type: console
---

# Background

## Context

Subset of MoMo-data up to three measurements per subject, MVPA, Minutes of sportengagement and socioeconomic status via MoMo-PAQ

## Issues

1. Influence of PA and sport on health (body comp)
2. Influence of sex
3. Influence of cohort
4. Influence of ses status

## Variables in file

+ Subj:	Subject id, random factor
+ age:	age in years, within-subject and within-time fixed factor
+ Sex:	sex of participant (levels: 1 = male, 2 = female), fixed factor
+ Time:	measuring point (3 levels: T1, T2, T3)
+ mvpa:	days per week with at least 60 min MVPA, 
+ sport:	weekly minutes of sport engagement corrected for seasonality
+ whr:	waist to hip ratio, dependent variable
+ ses:	socioeconomic status (Winkler)

# Preprocessing

## RK style guide

+ Random factors should be factors, not integers!
+ Factors capitalized, continuous variables in lower case
+ `Subj` instead of `ID`; prefix subject and item numbers with `S` and `I` 
+ Short variable names and factor levels, but respect tradeoff with mmemonic value
+ Labels should be of equal length
+ Hint: Leave out vowels in names and labels
+ See Jenny Bryan's [Naming Things](https://docplayer.net/55248970-Naming-things-prepared-by-jenny-bryan-for-reproducible-science-workshop.html)

## Packages

```{r}
library(easystats)
library(tidyverse)
library(lme4)
library(hypr)
library(summarytools)

# respecting color vision deficiency
cbPalette <- c( "#0072B2", "#D55E00", "#009E73", "#CC79A7",
                "#F0E442", "#56B4E9", "#999999", "#E69F00")
```

## Read and transform data

```{r}
dat <- 
  readRDS("KOLB.rds") |> 
  rename(Subj = subID, Sex=sex, Time=time, mvpa=MVPA) |> 
  filter(!is.na(whr) & whr <= 1.0 & !is.na(mvpa)) |> 
  mutate(Subj = factor(paste0("S", str_pad(Subj, width = 5, side = "left", pad = "0"))),
         Sex =  fct_recode(as_factor(Sex), "female" = "weiblich", "male" ="männlich"),
         Time = factor(Time)
         )
stview(dfSummary(dat))

table <- dat |> count(Subj) |> count(N=n)

MASS::boxcox(whr ~ Sex*Time, data=dat) # looks good
```

**Issues**

+ Missing values on `Time`, `mvpa`, `whr`
+ Most subjects have only one assessment

# Descriptives (smooths)

```{r}
dat |> 
  ggplot(aes(x=mvpa, y=whr, group=Time, color=Time)) +
  geom_smooth(method="lm") +
  facet_grid(. ~  Sex) +
  scale_colour_manual("Time", values=cbPalette) +
  scale_x_continuous("Days per week with at least 60 min MVPA") +
  scale_y_continuous("Waist-hip ratio") +
  theme_bw() +
  coord_cartesian(xlim=c(0, 7), ylim=c(0.7, 0.85))
```

# Linear mixed models

## Contrasts

+ `contr.sum` uses ‘sum to zero contrasts’, that is returns the difference of factor level means to Grand Mean (except for the last level); Grand Mean is mean of condition means. 
+ `contr.helmert` returns Helmert contrasts, which contrast the second level with the first, the third with the average of the first two, and so on. 

```{r}
contrasts(dat$Sex) <- contr.sum(2)
contrasts(dat$Sex)

contrasts(dat$Time) <- contr.helmert(3)
contrasts(dat$Time)
```

## _A priori_ LMM

```{r}
m_voi1 <- lmer(whr ~ 1 + Time*Sex*mvpa + (1 | Subj), data=dat, REML=FALSE,
              control=lmerControl(calc.derivs=FALSE))
print(summary(m_voi1), corr=FALSE)
```

## _Post-hoc_ LMM

```{r}
m_voi2 <- lmer(whr ~ 1 + (Time*Sex)/mvpa + (1 | Subj), data=dat, REML=FALSE,
              control=lmerControl(calc.derivs=FALSE))
anova(m_voi1, m_voi2)

print(summary(m_voi2), corr=FALSE)
```

# Abstract

[Molarius et al. (1999).](https://pubmed.ncbi.nlm.nih.gov/10078844/) Waist and hip circumferences, and waist-hip ratio in 19 populations of the WHO MONICA Project. _Int J Obes Relat Metab Disord. 23(2)_, 116-25.

**Objective:** To assess differences in waist and hip circumferences and waist-to-hip ratio (WHR) measured using a standard protocol among populations with different prevalences of overweight. In addition, to quantify the associations of these anthropometric measures with age and degree of overweight.

**Design:** Cross-sectional study of random population samples.

**Subjects:** More than 32000 men and women aged 25-64y from 19 (18 in women) populations participating in the second MONItoring trends and determinants in CArdiovascular disease (MONICA) survey from 1987-1992.

**Results:** Age standardized mean waist circumference range between populations from 83-98 cm in men and from 78-91cm in women. Mean hip circumference ranged from 94-105cm and from 97-108cm in men and women, respectively, and mean WHR from 0.87-0.99 and from 0.76-0.84, respectively. Together, height, body mass index (BMI), age group and population explained about 80% of the variance in waist circumference. BMI was the predominant determinant (77% in men, 75% women). Similar results were obtained for hip circumference. However, height, BMI, age group and population, accounted only for 49% (men) and 30% (women) the variation in WHR.

**Conclusion:** Considerable variation in waist and hip circumferences and WHR were observed among the study populations. Waist circumference and WHR, both of which are used as indicators of abdominal obesity, seem to measure different aspects of the human body: waist circumference reflects mainly the degree of overweight whereas WHR does not.

# Appendix

```{r}
sessionInfo()
```

