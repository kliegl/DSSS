---
title: "Analyses of Japanese Animations Ratings: Preprocessing"
author: "Anastasia Yanecko"
date: "2022-02-28 (updated: `r Sys.Date()`)"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_depth: 2
    toc_float: no
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

# Background

<Add five to ten sentences about the study and goals of analysis.>

# Setup

```{r}
library(tidyverse)
library(readxl)
library(lubridate)
library(summarytools)
```

# Reading the data

```{r}
data <- read.csv("data/Yanechko_1_Anime.csv")

dat <- 
  data %>% 
  as_tibble() |>  
  filter(Rank >= 150) %>%
  select("Rating", "Episodes", "Type")
```

# Preprocessing

```{r}
dat$Type <- factor(dat$Type)
levels(dat$Type)[1:8] <- c("DVD", "Movie", "Music", "Other", "OVA", "TV", "TV_Sp", "Web")

dat$Type <- factor(dat$Type, levels=c("TV", "Movie", "Web", "OVA", "Music", "TV_Sp", "DVD", "Other"))
```


# Generating summary statistics

```{r}
#view(dfSummary(dat))

descr(dat, stats = "common")  # my preference
descr(dat, stats = "fivenum")

dat |> dplyr::select(Type) |> freq()
```

We do not get a statistic for such variables as Name, Japanese_name, Type, Studio, Release_season, Tags, Description, Content_Warning, Related_Mange, Related_anime, Voice_actors, staff, because they are non-numerical variables.  If you want the frequencies associated with character variables, you can use the `freq()`.


# Graph

```{r}
table <- 
  dat |> 
  filter(!is.na(Rating) & !is.na(Episodes)) |> 
  group_by(Type) |> 
  summarise(N=n(), epi_max=max(Episodes), rating_M = mean(Rating))
table

dat |> 
  filter(!is.na(Rating) & !is.na(Episodes)) |> 
  ggplot(aes(x = Episodes, y = Rating, group=Type, colour = Type)) + 
  geom_smooth(method="lm", formula=y~poly(x,2), se=FALSE) +
  scale_x_continuous("Episodes", breaks=seq(0,800,50)) +
  theme_bw()
```

Comment: We can see trendlines only for anime series on TV, Web and OVA.

+ As for TV, the amount of episodes doesn't seem to have an effect on anime's rating. 
+ As for OVA, it seems that the more episodes, the better rating this type of anime has. 
+ As for Web, it seems that if the most optimal amount of episodes is approximately 50; up to this point the more episodes the show has, the better rating it gets. However, after that point the more episodes web anime has, the worse rating it gets. 

# Appendix

```{r}
sessionInfo()
```